<script src="http://js.pusherapp.com/1.8/pusher.min.js" type="text/javascript"></script>
<script type="text/javascript">
  // Enable pusher logging - don't include this in production
  Pusher.log = function(message) {
    if (window.console && window.console.log) window.console.log(message);
  };

  // Flash fallback logging - don't include this in production
  WEB_SOCKET_DEBUG = true;

  window.pusher = new Pusher('83cad248adce476e852e');
  
  <% if @board %>
    window.channel = pusher.subscribe('<%= "board-#{@board.id}" %>');
  
    channel.bind('created', function(data) {
    create_note_at_dom(data.note, $('#field_' + data.note.note.field_id), window.current_user == data.user);
  });
  channel.bind('destroyed', function(data){
		delete_note(data.note.id);
	});
	channel.bind('updated', function(data){
		update_note(data);
	});
			
			
			
      
      
	window.current_user = <%= current_user.id %>
	<% else %>
      window.channel = pusher.subscribe('<%= "overview" %>');
  
  
  <% end %>
  
</script>
